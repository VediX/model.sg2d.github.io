<html lang="en-US" style=""><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>SGModel | A fast lightweight library (ES6) for structuring web applications using binding models and custom events. This is a faster and more simplified analogue of Backbone.js!</title>
<meta name="generator" content="Jekyll v3.9.0">
<meta property="og:title" content="SGModel">
<meta property="og:locale" content="en_US">
<meta name="description" content="A fast lightweight library (ES6) for structuring web applications using binding models and custom events. This is a faster and more simplified analogue of Backbone.js!">
<meta property="og:description" content="A fast lightweight library (ES6) for structuring web applications using binding models and custom events. This is a faster and more simplified analogue of Backbone.js!">
<link rel="canonical" href="https://model.sg2d.ru/">
<meta property="og:url" content="https://model.sg2d.ru/">
<meta property="og:site_name" content="SGModel">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="SGModel">
<script type="application/ld+json">
{"description":"A fast lightweight library (ES6) for structuring web applications using binding models and custom events. This is a faster and more simplified analogue of Backbone.js!","url":"https://model.sg2d.ru/","@type":"WebSite","headline":"SGModel","name":"SGModel","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=c5d094c78c0002c011cb5cf8248926586065d62b">
    <script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
    <script src="/assets/js/respond.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="/assets/css/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body style="padding-bottom: 5px;">
      <div id="header">
        <nav style="text-align: center; background: transparent;">
          <li class="fork" style="float: none"><a href="https://github.com/VediX/model.sg2d.github.io">View On GitHub</a></li>
          
        </nav>
      </div><!-- end header -->

    <div class="wrapper">

      <section style="padding-top: 5px; padding-bottom: 5px;">
        <div id="title" style="margin-bottom: 10px;">
          <h1>SGModel</h1>
          <p>A fast lightweight library (ES6) for structuring web applications using binding models and custom events. This is a faster and more simplified analogue of Backbone.js!</p>
          <hr>
          <span class="credits left">Project maintained by <a href="https://github.com/VediX">VediX</a></span>
          <span class="credits right">Hosted on GitHub Pages — Theme by <a href="https://twitter.com/michigangraham">mattgraham</a></span>
        </div>

        <h1 id="sgmodel">SGModel</h1>

<p>Быстрая легковесная библиотека-класс для структурирования веб-приложений с помощью биндинг-моделей и пользовательских событий. Это более быстрый и упрощенный аналог Backbone.js! Библиотека хорошо адаптирована для наследования классов (ES6).</p>

<h2 id="оглавление">Оглавление</h2>

<p><a href="#%D0%BF%D1%80%D0%BE%D1%81%D1%82%D0%BE%D0%B9-%D0%BF%D1%80%D0%B8%D0%BC%D0%B5%D1%80-%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F">Простой пример использования</a></p>

<p><a href="#%D0%BE%D1%81%D0%BD%D0%BE%D0%B2%D0%BD%D1%8B%D0%B5-%D1%81%D1%82%D0%B0%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B5-%D1%81%D0%B2%D0%BE%D0%B9%D1%81%D1%82%D0%B2%D0%B0-sgmodel">Основные статические свойства SGModel</a></p>

<p><a href="#%D1%81%D0%B2%D0%BE%D0%B9%D1%81%D1%82%D0%B2%D0%B0-%D0%B8-%D0%BC%D0%B5%D1%82%D0%BE%D0%B4%D1%8B-%D1%8D%D0%BA%D0%B7%D0%B5%D0%BC%D0%BF%D0%BB%D1%8F%D1%80%D0%B0">Свойства и методы экземпляра</a></p>

<p><a href="#%D1%81%D0%BE%D0%B1%D1%81%D1%82%D0%B2%D0%B5%D0%BD%D0%BD%D1%8B%D0%B5-%D1%81%D0%B5%D1%82%D1%82%D0%B5%D1%80%D1%8B">Собственные сеттеры</a></p>

<p><a href="#%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D0%B0-singleton-%D0%BF%D0%B0%D1%82%D1%82%D0%B5%D1%80%D0%BD%D0%B0">Поддержка Singleton паттерна</a></p>

<p><a href="#%D1%83%D1%82%D0%B8%D0%BB%D0%B8%D1%82%D1%8B-%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D1%83%D0%B5%D0%BC%D1%8B%D0%B5-%D0%B2-sgmodel">Утилиты, используемые в SGModel</a></p>

<h2 id="простой-пример-использования">Простой пример использования</h2>

<h3 id="файл-indexjs">Файл ./index.js</h3>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="dl">"</span><span class="s2">use strict</span><span class="dl">"</span><span class="p">;</span>

<span class="k">import</span> <span class="nx">Tile</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./tile.js</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">tile1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Tile</span><span class="p">({</span> <span class="na">position</span><span class="p">:</span> <span class="p">{</span><span class="na">x</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="na">y</span><span class="p">:</span> <span class="mi">20</span><span class="p">},</span> <span class="na">angle</span><span class="p">:</span> <span class="mi">180</span> <span class="p">});</span>

<span class="nx">tile1</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">"</span><span class="s2">position</span><span class="dl">"</span><span class="p">,</span> <span class="p">(</span><span class="nx">position</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="nx">position</span><span class="p">.</span><span class="nx">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="nx">position</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="nx">position</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="nx">position</span><span class="p">.</span><span class="nx">x</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">)</span> <span class="nx">position</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">)</span> <span class="nx">position</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
<span class="p">});</span>

<span class="nx">tile1</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="dl">"</span><span class="s2">angle</span><span class="dl">"</span><span class="p">,</span> <span class="mi">365</span><span class="p">);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">angle=</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">tile1</span><span class="p">.</span><span class="nx">properties</span><span class="p">.</span><span class="nx">angle</span><span class="p">);</span> <span class="c1">// "angle=5"</span>

<span class="nx">tile1</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="dl">"</span><span class="s2">position</span><span class="dl">"</span><span class="p">,</span> <span class="p">{</span><span class="na">x</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="na">y</span><span class="p">:</span> <span class="mi">110</span><span class="p">});</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">position=(</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">tile1</span><span class="p">.</span><span class="nx">properties</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">x</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">,</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">tile1</span><span class="p">.</span><span class="nx">properties</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">)</span><span class="dl">"</span><span class="p">);</span> <span class="c1">// "position=(10,100)"</span>

</code></pre></div></div>

<h3 id="файл-tilejs">Файл ./tile.js</h3>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="dl">"</span><span class="s2">use strict</span><span class="dl">"</span><span class="p">;</span>

<span class="k">import</span> <span class="nx">SGModel</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./libs/sg-model.js</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">Tile</span> <span class="kd">extends</span> <span class="nx">SGModel</span> <span class="p">{</span>

	<span class="c1">// Описываем типы данных свойств (не обязательно)</span>
	<span class="kd">static</span> <span class="nx">typeProperties</span> <span class="o">=</span> <span class="p">{</span> <span class="c1">// overriden with Object.assign(...)</span>
		<span class="na">position</span><span class="p">:</span> <span class="nx">SGModel</span><span class="p">.</span><span class="nx">TYPE_OBJECT_NUMBERS</span><span class="p">,</span>
		<span class="na">angle</span><span class="p">:</span> <span class="nx">SGModel</span><span class="p">.</span><span class="nx">TYPE_NUMBER</span>
	<span class="p">};</span>
	
	<span class="nx">defaults</span><span class="p">()</span> <span class="p">{</span>
		<span class="k">return</span> <span class="p">{</span>
			<span class="na">position</span><span class="p">:</span> <span class="p">{</span><span class="na">x</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="na">y</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>
			<span class="na">angle</span><span class="p">:</span> <span class="mi">0</span>
		<span class="p">};</span>
	<span class="p">}</span>
	
	<span class="nx">initialize</span><span class="p">(</span><span class="nx">properties</span><span class="p">,</span> <span class="nx">thisProps</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
	
		<span class="k">this</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">"</span><span class="s2">angle</span><span class="dl">"</span><span class="p">,</span> <span class="p">(</span><span class="nx">angle</span><span class="p">,</span> <span class="nx">angle_prev</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="nx">angle</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="nx">angle</span> <span class="o">=</span> <span class="nx">angle</span> <span class="o">+</span> <span class="mi">360</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="nx">angle</span> <span class="o">&gt;</span> <span class="mi">360</span><span class="p">)</span> <span class="nx">angle</span> <span class="o">=</span> <span class="nx">angle</span> <span class="o">-</span> <span class="mi">360</span><span class="p">;</span>
			<span class="k">return</span> <span class="nx">angle</span><span class="p">;</span>
		<span class="p">});</span>
	<span class="p">}</span>
	
	<span class="nx">destroy</span><span class="p">()</span> <span class="p">{</span>
		<span class="c1">//...</span>
		<span class="k">super</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
	<span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="основные-статические-свойства-sgmodel">Основные статические свойства SGModel</h2>

<h3 id="static-typeproperties--">static typeProperties = {…}</h3>

<p>Описание типов свойств. Пример кода:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">PlayerBase</span> <span class="kd">extends</span> <span class="nx">SGModel</span> <span class="p">{</span>

	<span class="kd">static</span> <span class="nx">typeProperties</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">({</span>
		<span class="na">position</span><span class="p">:</span> <span class="nx">SGModel</span><span class="p">.</span><span class="nx">TYPE_OBJECT_NUMBERS</span><span class="p">,</span>
		<span class="na">rotate</span><span class="p">:</span> <span class="nx">SGModel</span><span class="p">.</span><span class="nx">TYPE_NUMBER</span>
	<span class="p">},</span> <span class="nx">SGModel</span><span class="p">.</span><span class="nx">typeProperties</span><span class="p">);</span>
	
	<span class="c1">//...</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nx">Tank</span> <span class="kd">extends</span> <span class="nx">PlayerBase</span> <span class="p">{</span>
	
	<span class="kd">static</span> <span class="nx">typeProperties</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">({</span>
		<span class="na">armor</span><span class="p">:</span> <span class="nx">SGModel</span><span class="p">.</span><span class="nx">TYPE_NUMBER</span><span class="p">,</span>
		<span class="na">ammunition1</span><span class="p">:</span> <span class="nx">SGModel</span><span class="p">.</span><span class="nx">TYPE_NUMBER</span><span class="p">,</span>
		<span class="na">ammunition2</span><span class="p">:</span> <span class="nx">SGModel</span><span class="p">.</span><span class="nx">TYPE_NUMBER</span><span class="p">,</span>
		<span class="na">ammunition3</span><span class="p">:</span> <span class="nx">SGModel</span><span class="p">.</span><span class="nx">TYPE_NUMBER</span>
	<span class="p">},</span> <span class="nx">PlayerBase</span><span class="p">.</span><span class="nx">typeProperties</span><span class="p">);</span>
	
	<span class="c1">//...</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="поддерживаемые-типы-свойств">Поддерживаемые типы свойств</h4>

<ul>
  <li><code class="language-plaintext highlighter-rouge">SGModel.TYPE_ANY</code> - тип свойства по умолчанию</li>
  <li><code class="language-plaintext highlighter-rouge">SGModel.TYPE_NUMBER</code></li>
  <li><code class="language-plaintext highlighter-rouge">SGModel.TYPE_STRING</code></li>
  <li><code class="language-plaintext highlighter-rouge">SGModel.TYPE_BOOL</code></li>
  <li><code class="language-plaintext highlighter-rouge">SGModel.TYPE_OBJECT</code> - при изменении хотя бы одного свойства объекта выполняются колбэки заданные методом .on()</li>
  <li><code class="language-plaintext highlighter-rouge">SGModel.TYPE_ARRAY</code> - при изменении хотя бы одного элемента массива выполняются колбэки заданные методом .on()</li>
  <li><code class="language-plaintext highlighter-rouge">SGModel.TYPE_ARRAY_NUMBERS</code> - то же что и SGModel.TYPE_ARRAY, но значения приводятся к числовому типу</li>
  <li><code class="language-plaintext highlighter-rouge">SGModel.TYPE_OBJECT_NUMBERS</code> - то же что и SGModel.TYPE_OBJECT, но значения приводятся к числовому типу</li>
  <li><code class="language-plaintext highlighter-rouge">SGModel.TYPE_NUMBER_OR_XY</code> - либо число, например, 1234.5, либо объект, например: {x: 1234.5, y: 1234.5}. Этот тип удобен для работы с графическими движками</li>
</ul>

<p>(!) При проверке изменения значения везде применяется строгая проверка (===).</p>

<h3 id="static-defaultsproperties--">static defaultsProperties = {…}</h3>

<p>Один из способов задания перечня свойств и их значений по умолчанию при создании экземпляра. Другой способ - использовать метод <code class="language-plaintext highlighter-rouge">defaults()</code> экземпляра, см. ниже.</p>

<p>Пример кода:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">PlayerBase</span> <span class="kd">extends</span> <span class="nx">SGModel</span> <span class="p">{</span>

	<span class="c1">//...</span>

	<span class="kd">static</span> <span class="nx">defaultProperties</span> <span class="o">=</span> <span class="p">{</span>
		<span class="na">position</span><span class="p">:</span> <span class="p">{</span><span class="na">x</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="na">y</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>
		<span class="na">rotate</span><span class="p">:</span> <span class="mi">0</span>
	<span class="p">}</span>
	
	<span class="c1">//...</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nx">Tank</span> <span class="kd">extends</span> <span class="nx">PlayerBase</span> <span class="p">{</span>

	<span class="c1">//...</span>

	<span class="nx">defaults</span><span class="p">()</span> <span class="p">{</span>
		<span class="k">return</span> <span class="nx">SGModel</span><span class="p">.</span><span class="nx">defaults</span><span class="p">({</span>
			<span class="na">armor</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
			<span class="na">ammunition1</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
			<span class="na">ammunition2</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
			<span class="na">ammunition3</span><span class="p">:</span> <span class="mi">5</span>
		<span class="p">},</span> <span class="nx">PlayerBase</span><span class="p">.</span><span class="nx">defaultProperties</span><span class="p">);</span>
	<span class="p">}</span>
	
	<span class="c1">//...</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="static-localstoragekey--">static localStorageKey = “”</h3>

<p>Если задано не пустое строковое значение, то данные синхронизируются с локальным хранилищем.
Поддержка хранения данных как одного экземпляра класса (single instance), так и нескольких экземпляров: <code class="language-plaintext highlighter-rouge">localStorageKey+"_"+id</code></p>

<h2 id="свойства-и-методы-экземпляра">Свойства и методы экземпляра</h2>

<h3 id="id">id</h3>

<p>Уникальный числовой идентификатор экземпляра. Генерируется автоматически при создании экземпляра, если не был передан вручную.</p>

<p>Если при создании экземпляра нужно заполнить его данными из локального хранилища localStorage (синхронизировать), то id необходимо указать заранее при вызове конструктора (в props). Также в этом случае необходимо задать <code class="language-plaintext highlighter-rouge">localStorageKey</code>.</p>

<h3 id="changed--false">changed = false</h3>

<p>Если какое-то свойство было изменено, то устанавливается в true. Сбрасывается вручную (в false).</p>

<h3 id="destroyed--false">destroyed = false</h3>

<p>Если true, значит экземпляр прошёл процедуру уничтожения destroy()</p>

<h3 id="constructorprops-thisprops-options">constructor(props, thisProps, options)</h3>

<ul>
  <li>props - свойства</li>
  <li>thisProps - свойства и методы передающиеся в контекст this созданного экземпляра</li>
  <li>options - пользовательские настройки</li>
</ul>

<h3 id="defaults">defaults()</h3>

<p>Один из способов задания перечня свойств и их значений по умолчанию при создании экземпляра.
Этот вариант предпочтителен, когда нужно обратиться к статическим свойствам и методам класса.
Другой способ - использовать <code class="language-plaintext highlighter-rouge">static defaultsProperties = {...}</code>, см. выше.</p>

<h3 id="initializeproperties-thisprops-options---override">initialize(properties, thisProps, options) {} // override</h3>

<p>Вызывается сразу после создании экземпляра. Переопределяется в классах потомках</p>

<h3 id="setname-value-flags--0-options--void-0">set(name, value, flags = 0, options = void 0)</h3>

<p>Задать значение свойства</p>

<ul>
  <li>name</li>
  <li>val</li>
  <li>flags	- допустимые флаги:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">SGModel.FLAG_OFF_MAY_BE</code> - если при .set() могут быть .off() то нужно передать этот флаг</li>
      <li><code class="language-plaintext highlighter-rouge">SGModel.FLAG_PREV_VALUE_CLONE</code> - передавать предыдущее значение (делается тяжёлый clone)</li>
      <li><code class="language-plaintext highlighter-rouge">SGModel.FLAG_NO_CALLBACKS</code> - если задано, то колбэки не выполняются</li>
      <li><code class="language-plaintext highlighter-rouge">SGModel.FLAG_FORCE_CALLBACKS</code> - выполнить колбеки даже если нет изменений</li>
      <li><code class="language-plaintext highlighter-rouge">SGModel.FLAG_IGNORE_OWN_SETTER</code> - игнорировать собственные сеттеры (выполняется стандартный)</li>
    </ul>
  </li>
  <li>options
    <ul>
      <li>precision - Точность округления чисел</li>
      <li>previous_value - Если задано, то используется в качестве предыдущего значения</li>
    </ul>
  </li>
</ul>

<p>Возвращает true если свойство было изменено.</p>

<h3 id="getname">get(name)</h3>

<p>Получить значение свойства</p>

<h3 id="onname-func-context-data-flags--0">on(name, func, context, data, flags = 0)</h3>

<p>Задать колбэк на изменение свойства</p>

<ul>
  <li>name - имя свойства</li>
  <li>func - колбэк</li>
  <li>context - если не задано, то передаётся “this” текущего объекта</li>
  <li>data	- если задано, то в колбэке в первом arguments[] передаётся это значение (data)</li>
  <li>flags - допустимые флаги:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">SGModel.FLAG_IMMEDIATELY</code> - func выполнится сразу</li>
    </ul>
  </li>
</ul>

<h3 id="offname-func">off(name, func)</h3>

<p>Удалить колбэки из списка подписчиков на изменение свойства. Если задан func, то из списка удаляется конкретный колбэк</p>

<h3 id="triggername-flags--0">trigger(name, flags = 0)</h3>

<p>Выполнить колбэки, которые выполняются при изменении значения свойства</p>

<ul>
  <li>name - имя свойства</li>
  <li>flags - допустимые флаги:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">SGModel.FLAG_OFF_MAY_BE</code> - если при .set() могут быть .off() то нужно передать этот флаг</li>
    </ul>
  </li>
</ul>

<h3 id="save">save()</h3>

<p>Сохраняет данные в локальное хранилище localStorage.
При этом свойство, начинающееся с символа “_” не записывается в хранилище, а при инициализации экземпляра значение такого свойства берётся как по умолчанию!</p>

<h3 id="destroy">destroy()</h3>

<p>Очищает список колбэков и присваивает <code class="language-plaintext highlighter-rouge">destroyed = true</code></p>

<h2 id="собственные-сеттеры">Собственные сеттеры</h2>

<p>Предпочтительнее .on() по скорости работы при большом количестве экземпляров класса.
Также используются, если есть базовый класс и класс потомок, где нужно специфическое поведение при изменении свойств.</p>

<h3 id="static-ownsetters--">static ownSetters = {…}</h3>

<p>Список свойств для которых вначале использовать собственные сеттеры. Пример кода см. ниже.</p>

<p>Пример кода:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="kd">class</span> <span class="nx">PlayerBase</span> <span class="kd">extends</span> <span class="nx">SGModel</span> <span class="p">{</span>

	<span class="kd">static</span> <span class="nx">typeProperties</span> <span class="o">=</span> <span class="p">{</span>
		<span class="na">state</span><span class="p">:</span> <span class="nx">PlayerBase</span><span class="p">.</span><span class="nx">TYPE_NUMBER</span>
	<span class="p">};</span>
	
	<span class="kd">static</span> <span class="nx">defaultsProperties</span> <span class="o">=</span> <span class="p">{</span>
		<span class="na">state</span><span class="p">:</span> <span class="mi">0</span>
	<span class="p">};</span>
	
	<span class="c1">//...</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nx">Tank</span> <span class="kd">extends</span> <span class="nx">PlayerBase</span> <span class="p">{</span>

	<span class="kd">static</span> <span class="nx">typeProperties</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">({</span>
		<span class="na">state_index</span><span class="p">:</span> <span class="nx">PlayerBase</span><span class="p">.</span><span class="nx">TYPE_NUMBER</span>
	<span class="p">},</span> <span class="nx">PlayerBase</span><span class="p">.</span><span class="nx">typeProperties</span><span class="p">);</span>
	
	<span class="nx">defaults</span><span class="p">()</span> <span class="p">{</span>
		<span class="k">return</span> <span class="nx">SGModel</span><span class="p">.</span><span class="nx">defaults</span><span class="p">({</span>
			<span class="na">state_index</span><span class="p">:</span> <span class="mi">0</span>
		<span class="p">},</span> <span class="nx">PlayerBase</span><span class="p">.</span><span class="nx">defaultProperties</span><span class="p">);</span>
	<span class="p">}</span>
 
	<span class="c1">// В Tank указываем собственный сеттер для работы со свойством state</span>
	<span class="kd">static</span> <span class="nx">ownSetters</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">assign</span><span class="p">({</span>
		<span class="na">state</span><span class="p">:</span> <span class="kc">true</span>
	<span class="p">},</span> <span class="nx">PlayerBase</span><span class="p">.</span><span class="nx">ownSetters</span><span class="p">);</span>
	
	<span class="nx">setState</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">flags</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="dl">"</span><span class="s2">state</span><span class="dl">"</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">flags</span> <span class="o">|</span> <span class="nx">SGModel</span><span class="p">.</span><span class="nx">FLAG_IGNORE_OWN_SETTER</span><span class="p">,</span> <span class="nx">options</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">this</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="dl">"</span><span class="s2">state_index</span><span class="dl">"</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="поддержка-singleton-паттерна">Поддержка Singleton паттерна</h2>

<h3 id="static-singleinstance--false">static singleInstance = false</h3>

<p>Если true, то возможен только один действующий экземпляр класса.</p>

<p>Пример кода:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">Application</span> <span class="kd">extends</span> <span class="nx">SGModel</span> <span class="p">{</span>
	
	<span class="kd">static</span> <span class="nx">singleInstance</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
	<span class="kd">static</span> <span class="nx">localStorageKey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">app_options</span><span class="dl">"</span><span class="p">;</span>
	
	<span class="kd">static</span> <span class="nx">APP_STATE1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="kd">static</span> <span class="nx">APP_STATE2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="c1">//...</span>
	
	<span class="kd">constructor</span><span class="p">(...</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">super</span><span class="p">(...</span><span class="nx">args</span><span class="p">);</span>
		<span class="nb">window</span><span class="p">.</span><span class="nx">MyApp</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
		
		<span class="c1">//...</span>
	<span class="p">}</span>
	
	<span class="nx">defaults</span><span class="p">()</span> <span class="p">{</span>
		<span class="k">return</span> <span class="p">{</span>
			<span class="na">state</span><span class="p">:</span> <span class="nx">Application</span><span class="p">.</span><span class="nx">APP_STATE1</span>
		<span class="p">};</span>
	<span class="p">}</span>
	
	<span class="nx">initialize</span><span class="p">(</span><span class="nx">properties</span><span class="p">,</span> <span class="nx">thisProps</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
		<span class="c1">//...</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">new</span> <span class="nx">Application</span><span class="p">();</span>
</code></pre></div></div>

<h3 id="static-getinstancebignoreemptyfalse">static getInstance(bIgnoreEmpty=false)</h3>

<p>Получить указатель на одиночный экземляр класса. Если bIgnoreEmpty = true, то при пустом экземпляре Singleton ошибка игнорируется и возвращается null.</p>

<h3 id="static-get">static get(…)</h3>

<p>Проекция на метод get экземпляра</p>

<h3 id="static-set">static set(…)</h3>

<p>Проекция на метод set экземпляра</p>

<h3 id="static-on">static on(…)</h3>

<p>Проекция на метод on экземпляра</p>

<h3 id="static-off">static off(…)</h3>

<p>Проекция на метод off экземпляра</p>

<h2 id="утилиты-используемые-в-sgmodel">Утилиты, используемые в SGModel</h2>

<h3 id="static-defaultsdest-sources">static defaults(dest, …sources)</h3>

<p>Если какого-то свойства в dest не оказалось, то оно при наличии берётся из объектов sources</p>

<h3 id="static-clonesource">static clone(source)</h3>

<p>Полное клонирование объекта с вложенными массивами и объектами (используется рекурсия)</p>

<h3 id="static-initobjectbyobjectdest-source">static initObjectByObject(dest, source)</h3>

<p>Заполнить значения объекта/массива dest значениями из объекта/массива source (с рекурсией)</p>

<h3 id="static-upperfirstletters">static upperFirstLetter(s)</h3>

<p>Сделать первый символ прописным</p>


      </section>

    </div>

    
<!-- Yandex.Metrika counter -->
<script type="text/javascript" >(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)}; m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})	   (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym"); ym(80080672, "init", { clickmap:true, trackLinks:true, accurateTrackBounce:true });</script>
<noscript><div><img src="https://mc.yandex.ru/watch/80080672" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

</body></html>